<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Maytoni UNITY – Результаты подбора</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #e7f5fd;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background-color: white;
      padding: 20px;
      border: 1px solid #ddd;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      font-size: 18px;
      margin-bottom: 10px;
    }
    .results-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background-color: white;
    }
    .results-table th, .results-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .results-table th {
      background-color: #f4f4f4;
      font-weight: bold;
    }
    .results-table th:nth-child(3), 
    .results-table td:nth-child(3) {
      width: 100px;
    }
    .results-table th:nth-child(2), 
    .results-table td:nth-child(2) {
      width: 50px;
      text-align: center;
    }
    .total-price {
      font-weight: bold;
      text-align: right;
      margin-top: 10px;
    }
    .result-container {
      display: none;
    }
    .debug {
      font-size: 12px;
      color: red;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Заголовок для системы -->
    <h2 id="systemName">Начальное название</h2>
    
    <!-- Контейнер для вывода результатов подбора -->
    <div id="resultContainer" class="result-container">
      <table class="results-table" id="resultsTable">
        <thead id="tableHeader">
          <tr>
            <th>Наименование</th>
            <th>кол.</th>
            <th>Цена за шт.</th>
            <th>Общая цена</th>
          </tr>
        </thead>
        <tbody id="results">
          <!-- Результаты подбора будут выведены здесь -->
        </tbody>
      </table>
      <div id="totalPrice" class="total-price"></div>
    </div>
    
    <!-- Отладочный блок (опционально) -->
    <div id="debug" class="debug"></div>
  </div>
  
  <script>
    // Ждем полной загрузки DOM
    document.addEventListener("DOMContentLoaded", function() {
      
      function showSelection() {
        console.log("Начало работы showSelection");
        
        var systemNameEl = document.getElementById("systemName");
        if (systemNameEl) {
          systemNameEl.textContent = "Maytoni UNITY";
        } else {
          console.error("Элемент с id 'systemName' не найден.");
        }
        
        // Здесь реализуйте вашу логику подбора трековой системы.
        // В данном примере используется упрощённая логика для демонстрации:
        // выбираем один компонент в зависимости от длины A.
        var lengthA = 150; // Пример: 150 см. (В реальной логике получаем значение из формы)
        var lengthOptions = [
          { "min": 0, "max": 100, "items": ["TRX001-111B"] },
          { "min": 101, "max": 200, "items": ["TRX001-112B"] },
          { "min": 201, "max": 300, "items": ["TRX001-113B"] }
        ];
        
        var components = {
          "TRX001-111B": { "name": "Шинопровод накладной черный 1м TRX001-111B", "price": 1500, "image": "images/TRX001-111B.png" },
          "TRX001-112B": { "name": "Шинопровод накладной черный 2м TRX001-112B", "price": 2500, "image": "images/TRX001-112B.png" },
          "TRX001-113B": { "name": "Шинопровод накладной черный 3м TRX001-113B", "price": 3490, "image": "images/TRX001-113B.png" }
        };
        
        var chosenId = "";
        if (lengthA <= 100) {
          chosenId = lengthOptions[0].items[0];
        } else if (lengthA <= 200) {
          chosenId = lengthOptions[1].items[0];
        } else if (lengthA <= 300) {
          chosenId = lengthOptions[2].items[0];
        } else {
          chosenId = lengthOptions[2].items[0];
        }
        
        var comp = components[chosenId];
        if (!comp) {
          console.error("Не найден компонент с ID " + chosenId);
          document.getElementById("results").innerHTML = "<tr><td colspan='4' style='text-align: center;'>Ошибка: компонент не найден</td></tr>";
          return;
        }
        
        // Формируем результат: выводим одну строку
        var tbody = document.getElementById("results");
        tbody.innerHTML = "<tr>" +
          "<td><img src='" + comp.image + "' alt='' style='width:50px; height:auto; margin-right:10px;'>" + comp.name + "</td>" +
          "<td style='background-color: white; text-align: center;'>1 шт.</td>" +
          "<td>" + comp.price + "р</td>" +
          "<td>" + comp.price + "р</td>" +
          "</tr>";
        
        var totalPriceEl = document.getElementById("totalPrice");
        totalPriceEl.innerHTML = "<div>Итого: " + comp.price + "р</div>";
        
        var resultContainerEl = document.getElementById("resultContainer");
        resultContainerEl.style.display = "block";
        
        var debugEl = document.getElementById("debug");
        debugEl.textContent = "Подбор выполнен для Maytoni UNITY";
        
        console.log("Подбор завершён успешно.");
      }
      
      function safeShowSelection() {
        try {
          showSelection();
        } catch (e) {
          console.error("Ошибка в showSelection:", e);
          alert("Произошла ошибка при подборе. Проверьте консоль для подробностей.");
        }
      }
      
      // Для демонстрации запускаем функцию через 1 секунду (замените вызов на реальное событие, если нужно)
      setTimeout(safeShowSelection, 1000);
    });
  </script>
</body>
</html>
